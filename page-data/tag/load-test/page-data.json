{"componentChunkName":"component---src-templates-tag-template-js","path":"/tag/load-test","result":{"data":{"site":{"siteMetadata":{"title":"Stefano's Space","subtitle":"Rare blog posts and some today-I-learned pills."}},"allMarkdownRemark":{"edges":[{"node":{"html":"<p>I’ve recently tried <a href=\"https://m.do.co/c/875cd23a5c97\" target=\"_blank\">Digitalocean</a> hosting and decided to host this blog on it. I’m running a <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mi mathvariant=\"normal\">/</mi><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>r</mi><mo separator=\"true\">,</mo><mi>o</mi><mi>r</mi><mi>d</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>t</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>y</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo separator=\"true\">,</mo><mi>w</mi><mi>i</mi><mi>t</mi><mi>h</mi><mn>1</mn><mi>C</mi><mi>P</mi><mi>U</mi><mo separator=\"true\">,</mo><mn>512</mn><mi>M</mi><mi>B</mi><mi>o</mi><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><mo separator=\"true\">,</mo><mn>20</mn><mi>G</mi><mi>B</mi><mi>S</mi><mi>S</mi><mi>D</mi><mi>a</mi><mi>n</mi><mi>d</mi><mn>1</mn><mi>T</mi><mi>B</mi><mi>o</mi><mi>f</mi><mi>b</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mi mathvariant=\"normal\">.</mi><mi>Y</mi><mi>o</mi><mi>u</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">5 / month server, or droplet as they call it, with 1 CPU, 512 MB of ram, 20 GB SSD and 1 TB of bandwidth. You even get</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">5/</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">ser</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">eyc</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">ll</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord\">1</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">CP</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">512</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">MB</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">am</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">20</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">GBSS</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">d</span><span class=\"mord\">1</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">TB</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">ban</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span></span></span></span>10 credit when you sign up, sweet!</p>\n<p>You may look down on a $5 machine but I’ve found it to be more than enough for my need.</p>\n<p>I’m serving “static” content that has been generated by <a href=\"https://gohugo.io\" target=\"_blank\">Hugo</a></p>\n<p>I recently ran some load testing at work for a newly launched website so I decided to test this $5 server. I’ve been using <a href=\"https://loader.io\" target=\"_blank\">loader.io</a> since its basic usage is free.</p>\n<h2 id=\"the-test\" style=\"position:relative;\"><a href=\"#the-test\" aria-label=\"the test permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The test</h2>\n<p>The server responds to a certain number of clients every second for a full minute.</p>\n<p>The majority of the users must receive the page in &#x3C; 5 secs. Only the html is loaded.</p>\n<h2 id=\"plain-html\" style=\"position:relative;\"><a href=\"#plain-html\" aria-label=\"plain html permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Plain HTML</h2>\n<p>10.000 requests a second! (that is the maximum that loaded.io goes on a free plan)</p>\n<h2 id=\"enable-strong-https\" style=\"position:relative;\"><a href=\"#enable-strong-https\" aria-label=\"enable strong https permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enable strong HTTPS</h2>\n<p><a href=\"https://www.ssllabs.com/ssltest/analyze.html?d=https%3A%2F%2Fstefano.chiodino.uk\" target=\"_blank\" data-vivaldi-spatnav-clickable=\"1\">How strong you say?</a></p>\n<p>As expected enabling https is taking its toll. The server can’t accommodate less than half of the requests, “just” 4.000.</p>\n<h2 id=\"full-on-pagespeed-on-strong-https\" style=\"position:relative;\"><a href=\"#full-on-pagespeed-on-strong-https\" aria-label=\"full on pagespeed on strong https permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Full on PageSpeed on strong HTTPS</h2>\n<p>I’ve then enabled Google’s PageSpeed module for Nginx and enabled every performance related filter!</p>\n<p>I’ve enabled 27 extra filters on top of the 34 enabled by default, leaving just 7 out that were just for compatibility or counterproductive, hell I’ve even enabled the filter to make the G analytics script async when it’s already implemented that way.</p>\n<p>Result: a quite dramatic 150 clients/sec 😀</p>\n<p>Here is the list of filters that I’ve enabled:</p>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\">pagespeed EnableFilters responsive_images<span class=\"token punctuation\">;</span>\npagespeed EnableFilters outline_css<span class=\"token punctuation\">;</span>\npagespeed EnableFilters outline_javascript<span class=\"token punctuation\">;</span>\npagespeed EnableFilters move_css_above_scripts<span class=\"token punctuation\">;</span>\npagespeed EnableFilters move_css_to_head<span class=\"token punctuation\">;</span>\npagespeed EnableFilters rewrite_style_attributes<span class=\"token punctuation\">;</span>\npagespeed EnableFilters prioritize_critical_css<span class=\"token punctuation\">;</span>\npagespeed EnableFilters make_google_analytics_async<span class=\"token punctuation\">;</span>\npagespeed EnableFilters canonicalize_javascript_libraries<span class=\"token punctuation\">;</span>\npagespeed EnableFilters inline_google_font_css<span class=\"token punctuation\">;</span>\npagespeed EnableFilters local_storage_cache<span class=\"token punctuation\">;</span>\npagespeed EnableFilters convert_to_webp_animated<span class=\"token punctuation\">;</span>\npagespeed EnableFilters insert_image_dimensions<span class=\"token punctuation\">;</span>\npagespeed EnableFilters inline_preview_images<span class=\"token punctuation\">;</span>\npagespeed EnableFilters resize_mobile_images<span class=\"token punctuation\">;</span>\npagespeed EnableFilters remove_comments<span class=\"token punctuation\">;</span>\npagespeed EnableFilters collapse_whitespace<span class=\"token punctuation\">;</span>\npagespeed EnableFilters elide_attributes<span class=\"token punctuation\">;</span>\npagespeed EnableFilters extend_cache_pdfs<span class=\"token punctuation\">;</span>\npagespeed EnableFilters sprite_images<span class=\"token punctuation\">;</span>\npagespeed EnableFilters rewrite_domains<span class=\"token punctuation\">;</span>\npagespeed EnableFilters trim_urls<span class=\"token punctuation\">;</span>\npagespeed EnableFilters remove_quotes<span class=\"token punctuation\">;</span>\npagespeed EnableFilters defer_javascript<span class=\"token punctuation\">;</span>\npagespeed EnableFilters dedup_inlined_images<span class=\"token punctuation\">;</span>\npagespeed EnableFilters lazyload_images<span class=\"token punctuation\">;</span>\npagespeed EnableFilters insert_dns_prefetch<span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"brotli-max-compression\" style=\"position:relative;\"><a href=\"#brotli-max-compression\" aria-label=\"brotli max compression permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Brotli (max compression)</h2>\n<p>Just add Accept-Encoding: br to loader.io request headers and… 75 clients / sec. Not bad considering that I’ve enabled the maximum (11) level of compression!</p>\n<p>..and, if you are curious about the compression, my homepage file sizes are (method from <a href=\"https://hacks.mozilla.org/2015/11/better-than-gzip-compression-with-brotli\" target=\"_blank\">Mozilla’s brotli post </a>):</p>\n<table>\n<thead>\n<tr>\n<th>Algorithm</th>\n<th>Size</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>none</td>\n<td>9508</td>\n</tr>\n<tr>\n<td>gzip</td>\n<td>3344</td>\n</tr>\n<tr>\n<td>brotli</td>\n<td>2732</td>\n</tr>\n</tbody>\n</table>","fields":{"slug":"/posts/server-load-test","categorySlug":"/category/programming/"},"frontmatter":{"title":"Server load test","date":"2016-05-14T13:50:14.000Z","category":"Programming"}}}]}},"pageContext":{"tag":"load test","currentPage":0,"postsLimit":8,"postsOffset":0,"prevPagePath":"/tag/load-test","nextPagePath":"/tag/load-test/page/1","hasPrevPage":false,"hasNextPage":false}},"staticQueryHashes":["1796801393","251939775","401334301"]}